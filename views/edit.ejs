<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Employee - Employee Payroll System</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="header">
    <div class="logo">
      <span class="logo-icon">ðŸ‘¤</span>
      <div class="logo-text">
        <span class="logo-title">EMPLOYEE</span>
        <span class="logo-subtitle">PAYROLL</span>
      </div>
    </div>
  </div>

  <div class="form-container">
    <h2 class="form-title">Edit Employee</h2>
    
    <% if (errors && errors.length > 0) { %>
      <div class="error-messages">
        <% errors.forEach(error => { %>
          <p class="error"><%= error %></p>
        <% }); %>
      </div>
    <% } %>
    
    <form action="/edit/<%= employee.id %>" method="POST" class="employee-form">
      <div class="form-group">
        <label for="name">Name</label>
        <input 
          type="text" 
          id="name" 
          name="name" 
          value="<%= employee.name || '' %>"
          required
        >
      </div>
      
      <div class="form-group">
        <label>Department</label>
        <div class="form-field-wrapper">
          <div class="radio-group">
            <label>
              <input type="radio" name="departmentRadio" value="HR" <%= employee.department === 'HR' ? 'checked' : '' %> onchange="toggleCustomDepartment()">
              HR
            </label>
            <label>
              <input type="radio" name="departmentRadio" value="Sales" <%= employee.department === 'Sales' ? 'checked' : '' %> onchange="toggleCustomDepartment()">
              Sales
            </label>
            <label>
              <input type="radio" name="departmentRadio" value="Finance" <%= employee.department === 'Finance' ? 'checked' : '' %> onchange="toggleCustomDepartment()">
              Finance
            </label>
            <label>
              <input type="radio" name="departmentRadio" value="Engineer" <%= employee.department === 'Engineer' ? 'checked' : '' %> onchange="toggleCustomDepartment()">
              Engineer
            </label>
            <label>
              <input type="radio" name="departmentRadio" value="Others" <%= !['HR', 'Sales', 'Finance', 'Engineer'].includes(employee.department) ? 'checked' : '' %> onchange="toggleCustomDepartment()">
              Others
            </label>
          </div>
          <input 
            type="text" 
            id="customDepartment" 
            name="customDepartment" 
            placeholder="Enter custom department"
            value="<%= !['HR', 'Sales', 'Finance', 'Engineer'].includes(employee.department) ? employee.department : '' %>"
            style="display: <%= !['HR', 'Sales', 'Finance', 'Engineer'].includes(employee.department) ? 'block' : 'none' %>;"
          >
          <input type="hidden" id="department" name="department" value="<%= employee.department || '' %>">
        </div>
      </div>
      
      <div class="form-group">
        <label for="salarySelect">Salary</label>
        <div class="form-field-wrapper">
          <% 
            const predefinedSalaries = [10000, 20000, 30000, 40000, 50000];
            const isCustomSalary = !predefinedSalaries.includes(employee.basicSalary);
          %>
          <select id="salarySelect" name="salarySelect" required onchange="toggleCustomSalary()">
            <option value="">Select Salary</option>
            <option value="10000" <%= employee.basicSalary === 10000 ? 'selected' : '' %>>â‚¹ 10,000</option>
            <option value="20000" <%= employee.basicSalary === 20000 ? 'selected' : '' %>>â‚¹ 20,000</option>
            <option value="30000" <%= employee.basicSalary === 30000 ? 'selected' : '' %>>â‚¹ 30,000</option>
            <option value="40000" <%= employee.basicSalary === 40000 ? 'selected' : '' %>>â‚¹ 40,000</option>
            <option value="50000" <%= employee.basicSalary === 50000 ? 'selected' : '' %>>â‚¹ 50,000</option>
            <option value="custom" <%= isCustomSalary ? 'selected' : '' %>>Custom Amount</option>
          </select>
          <input 
            type="number" 
            id="customSalary" 
            name="customSalary" 
            placeholder="Enter custom salary"
            min="0.01"
            step="0.01"
            value="<%= isCustomSalary ? employee.basicSalary : '' %>"
            style="display: <%= isCustomSalary ? 'block' : 'none' %>;"
          >
          <input type="hidden" id="basicSalary" name="basicSalary" value="<%= employee.basicSalary || '' %>">
        </div>
      </div>
      
      <div class="form-actions">
        <button type="submit" class="btn btn-submit">Update Employee</button>
        <a href="/" class="btn btn-cancel">Cancel</a>
      </div>
    </form>
  </div>

  <script>
    // Toggle custom department input
    function toggleCustomDepartment() {
      const selectedDept = document.querySelector('input[name="departmentRadio"]:checked').value;
      const customDeptInput = document.getElementById('customDepartment');
      const deptHidden = document.getElementById('department');
      
      if (selectedDept === 'Others') {
        customDeptInput.style.display = 'block';
        customDeptInput.required = true;
        deptHidden.value = customDeptInput.value;
      } else {
        customDeptInput.style.display = 'none';
        customDeptInput.required = false;
        customDeptInput.value = '';
        deptHidden.value = selectedDept;
      }
    }
    
    // Update hidden department field when custom input changes
    document.getElementById('customDepartment').addEventListener('input', function() {
      document.getElementById('department').value = this.value;
    });
    
    // Toggle custom salary input
    function toggleCustomSalary() {
      const selectedSalary = document.getElementById('salarySelect').value;
      const customSalaryInput = document.getElementById('customSalary');
      const salaryHidden = document.getElementById('basicSalary');
      
      if (selectedSalary === 'custom') {
        customSalaryInput.style.display = 'block';
        customSalaryInput.required = true;
        salaryHidden.value = customSalaryInput.value;
      } else {
        customSalaryInput.style.display = 'none';
        customSalaryInput.required = false;
        customSalaryInput.value = '';
        salaryHidden.value = selectedSalary;
      }
    }
    
    // Update hidden salary field when custom input changes
    document.getElementById('customSalary').addEventListener('input', function() {
      document.getElementById('basicSalary').value = this.value;
    });
    
    // Initialize on page load
    toggleCustomDepartment();
    toggleCustomSalary();
  </script>
</body>
</html>
